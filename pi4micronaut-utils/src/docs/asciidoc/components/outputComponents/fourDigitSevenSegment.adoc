:imagesdir: img/

ifndef::rootpath[]
:rootpath: ../../
endif::rootpath[]

ifdef::rootpath[]
:imagesdir: {rootpath}{imagesdir}
endif::rootpath[]

==== 4-Digit 7-Segment Display

[.text-right]
https://github.com/oss-slu/Pi4Micronaut/edit/develop/pi4micronaut-utils/src/docs/asciidoc/components/outputComponents/fourDigitSevenSegment.adoc[Improve this doc]

===== Overview

This section provides details of the 4-digit 7-segment display, including its components and assembly instructions.

===== Components

* 1 x Raspberry Pi
* 1 x Breadboard
* 1 x T-Extension Board
* 25 x Jumper Wire
* 4 x Resistor (220Î©)
* 1 x 4-Digit 7-Segment Display
* 1 x 74HC595
* Power source (appropriate voltage, typically 3.3V)

===== Assembly Instructions

* Connect the ground (GND) pins of the Raspberry Pi to the ground rails on the breadboard.
* Connect the two ground rails of the breadboard with a jumper wire.
* Place the 74HC595 on the breadboard.
* Place the four resistors on the breadboard.
* Place the 4-digit 7-segment display on the breadboard.
* Connect a jumper wire from each "digit" pin of the 4-digit 7-segment to one of the resistors.
* Connect the other end of the resistors to the Raspberry Pi's pins:

- Digit 1 to GPIO17 (BCM pin 18)
- Digit 2 to GPIO27 (BCM pin 27)
- Digit 3 to GPIO22 (BCM pin 22)
- Digit 4 to SPIMOSI (BCM pin 10)

// TODO: Describe connections to 74HC595

===== Circuit Diagram

image::four_digit_circuit.webp[]

===== Schematic Diagram

image::four_digit_schematic.webp[]

===== Functionality

The display can be enabled/disabled, display a custom value, or cleared.

Each digit of the display can display a digit 0 to 9, an uppercase letter A to F, a hypen (-), or a blank space.
Each of the four decimal points can also be turned on or off.

Example possible values include:

* "1" (displayed with the 1 in the first digit and the others blank)
* "8.8.8.8." (displayed with all segments enabled as `8.8.8.8.`)
* "A.-.42" (displayed as ```A.-.42```)

===== Testing

Use the below commands to test the component.
This will cause the display to turn on and display the value `1234`.

[source,bash]
----
$ curl http://localhost:8080/four-digit-seven-segment/enable
$ curl http://localhost:8080/four-digit-seven-segment/displayValue/1234
----

* `/enable` - Enables the display.
* `/disable` - Disables the display.
* `/displayValue/{value}` - Displays a custom value on the display.
* `/clear` - Clears the display.

===== Troubleshooting

* Display does not turn on
- Ensure all connections are secure and correct.
- Check the 74HC595 for proper orientation and placement.
- Ensure the software configuration matches the hardware setup.
- Look for any error messages in the console or logs.

* Display turns on but does not respond to commands
- Check the software configuration for any discrepancies.
- Ensure the 74HC595 is functioning properly.

===== YAML Configuration

[source,yaml]
----
i2c:
four-digit-seven-segment:
  name: 4 Digit 7 Segment Display
  bus: 1
  device: 0x27
----

===== Constructor and Methods

To see the constructor and methods of our FourDigitSevenSegmentHelper class see our javadoc link:https://oss-slu.github.io/Pi4Micronaut/javadoc/com/opensourcewithslu/outputdevices/FourDigitSevenSegmentHelper.html[here]
for more details.

===== An Example Controller

[source,java]
----
include::../../../../../../components/src/main/java/com/opensourcewithslu/components/controllers/FourDigitSevenSegmentDisplayController.java[tag=ex]
----
